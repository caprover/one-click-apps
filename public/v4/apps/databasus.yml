captainVersion: 4

caproverOneClickApp:
    variables:
        - id: '$$cap_databasus_tag'
          label: Databasus image tag
          defaultValue: 'latest'
          description: Check available tags at https://hub.docker.com/r/databasus/databasus/tags
          validRegex: '/.{1,}/'

    instructions:
        start: |-
            After deployment, access the web interface to configure
            database connections and backup targets (local or S3/MinIO).

        end: |-
            Databasus has been deployed successfully.

            Access it via:
            https://$$cap_appname.$$cap_root_domain

            All application data is stored in a persistent volume.

    displayName: Databasus
    isOfficial: false
    description: Web UI for automated backups of PostgreSQL, MySQL and MongoDB.
    documentation: https://databasus.com

services:
    $$cap_appname:
        image: databasus/databasus:$$cap_databasus_tag
        restart: always
        volumes:
            - $$cap_appname-data:/databasus-data
        caproverExtra:
            containerHttpPort: 4005
            waitForContainer: false

volumes:
    $$cap_appname-data:
