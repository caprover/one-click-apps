captainVersion: 4
caproverOneClickApp:
    displayName: 'imgproxy'
    description: 'Fast and secure standalone server for resizing and converting remote images'
    documentation: 'https://docs.imgproxy.net/'
    isOfficial: true
    instructions:
        start: |-
            imgproxy - Fast and secure standalone server for resizing and converting remote images.
            For more info visit https://imgproxy.net/.
        end: |-
            imgproxy has been successfully deployed as $$cap_appname.
            You can your configuration if necessary. For more info visit https://docs.imgproxy.net/.
    variables:
        - defaultValue: 3.6.0
          id: $$cap_imgproxy_version
          label: imgproxy Version
          validRegex: /^(?:2|3)(?:\.[0-9]+){0,2}$/
        - defaultValue: $$cap_gen_random_hex(128)
          id: $$cap_imgproxy_key
          label: Signature Key
          validRegex: /^[a-fA-F0-9]+$/
        - defaultValue: $$cap_gen_random_hex(128)
          id: $$cap_imgproxy_salt
          label: Signature Salt
          validRegex: /^[a-fA-F0-9]+$/
services:
    $$cap_appname:
        caproverExtra:
            containerHttpPort: 5000
        environment:
            IMGPROXY_BIND: 0.0.0.0:5000
            IMGPROXY_KEY: $$cap_imgproxy_key
            IMGPROXY_SALT: $$cap_imgproxy_salt
        image: darthsim/imgproxy:v$$cap_imgproxy_version
        restart: unless-stopped
