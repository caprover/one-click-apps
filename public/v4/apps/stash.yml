captainVersion: 4
services:
    $$cap_appname:
        image: stashapp/stash:$$cap_stash_version
        environment:
            TZ: $$cap_tz
            STASH_STASH: '/data/'
            STASH_GENERATED: '/generated/'
            STASH_METADATA: '/metadata/'
            STASH_CACHE: '/cache/'
        logging:
            driver: 'json-file'
            options:
                max-file: '10'
                max-size: '2m'
        hostname: $$cap_appname.$$cap_root_domain
        volumes:
            - /etc/localtime:/etc/localtime:ro
            - $$cap_appname-config:/root/.stash
            - $$cap_appname-metadata:/metadata
            - $$cap_appname-cache:/cache
            - $$cap_appname-generated:/generated
            - $$path_to_media:/data
        caproverExtra:
            containerHttpPort: 9999
caproverOneClickApp:
    variables:
        - id: $$cap_stash_version
          label: Stash Version
          defaultValue: latest
          description: Check out their Docker page for the valid tags https://hub.docker.com/r/stashapp/stash/tags
          validRegex: /^([^\s^\/])+$/
        - id: $$cap_tz
          label: Time Zone
          defaultValue: Europe/Brussels
          description: Get yours from https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
          validRegex: /.{1,}/
        - id: $$path_to_media
          label: Path to media folder
          description: Point this at your video collection.
          validRegex: /\/[^\s-][a-zA-Z0-9_\/-]*[^\/][^\s-]/
    instructions:
        start: >-
            An organizer for your porn, written in Go
        end: >-
            Stash is deployed and available as $$cap_appname.
    displayName: Stash
    isOfficial: true
    description: An organizer for your porn, written in Go
    documentation: Taken from https://hub.docker.com/r/stashapp/stash.
